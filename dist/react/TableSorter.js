!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jQuery"),require("_"),require("d3"),require("React"),require("ReactDOM"));else if("function"==typeof define&&define.amd)define(["jQuery","_","d3","React","ReactDOM"],e);else{var n="object"==typeof exports?e(require("jQuery"),require("_"),require("d3"),require("React"),require("ReactDOM")):e(t.jQuery,t._,t.d3,t.React,t.ReactDOM);for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(this,function(t,e,n,i,r){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(12),o=n(13),a=n(1),s=n(9),l=function(t){function e(){t.apply(this,arguments)}return i(e,t),e.prototype.componentDidMount=function(){this.node=o.findDOMNode(this),this.tableSorter=new s.TableSorter(a(this.node)),this.attachEvents(),this.renderContent()},e.prototype.componentWillReceiveProps=function(t){this.renderContent(t)},e.prototype.render=function(){return r.createElement("div",{style:{width:"100%",height:"100%"}})},e.prototype.attachEvents=function(){var t=this,e=function(e){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i-0]=arguments[i];t.props[e]&&t.props[e].apply(t,n)}};this.tableSorter.events.on(s.TableSorter.EVENTS.SELECTION_CHANGED,e("onSelectionChanged")),this.tableSorter.events.on(s.TableSorter.EVENTS.LOAD_MORE_DATA,e("onLoadMoreData")),this.tableSorter.events.on(s.TableSorter.EVENTS.FILTER_CHANGED,e("onFilterChanged")),this.tableSorter.events.on(s.TableSorter.EVENTS.SORT_CHANGED,e("onSortChanged"))},e.prototype.renderContent=function(t){if(t=t||this.props,this.tableSorter.settings=this.getSettingsFromProps(t),this.tableSorter.count=t.count||100,t.provider&&t.cols){var e=this.tableSorter.configuration||{primaryKey:t.cols[0].column,columns:[]};e.columns=t.cols,this.tableSorter.configuration=e}this.tableSorter.dataProvider=t.provider},e.prototype.getSettingsFromProps=function(t){return{selection:{singleSelect:t.singleSelect,multiSelect:t.multiSelect},presentation:{values:t.showValues,stacked:t.showStacked,histograms:t.showHistograms,animation:t.showAnimations}}},e}(r.Component);e.TableSorter=l},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e){t.exports=n},function(t,e){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){"use strict";function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&i()}function i(){if(!u){var t=setTimeout(n);u=!0;for(var e=l.length;e;){for(a=l,l=[];++c<e;)a&&a[c].run();c=-1,e=l.length}a=null,u=!1,clearTimeout(t)}}function r(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},l=[],u=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new r(t,e)),1!==l.length||u||setTimeout(i,0)},r.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,n){var i,r,o;(function(){function a(t,e,n){var i;!function(t,e,n,i){function r(i,r,o){var a,s;return this.storage=i.storage,this.spec=i,this.$container=r,this.tooltip=t.createTooltip(r.node()),this.tooltip.hide(),this.listeners=e.dispatch("hover","change-sortcriteria","change-filter","columns-changed","selected","multiselected","generate-histogram"),this.config=n.extend(!0,{},t.defaultConfig,o,{columnBundles:{primary:{sortedColumn:null,sortingOrderAsc:!0,prevRowScale:null}}}),this.storage.config=this.config,this.config.svgLayout.addPlusSigns||(this.config.svgLayout.plusSigns={}),"combined"===this.config.svgLayout.mode?(r.classed("lu-mode-combined",!0),this.$table=r.append("svg").attr("class","lu"),a=this.$table.append("defs"),a.append("defs").attr("class","columnheader"),a.append("defs").attr("class","column"),a.append("defs").attr("class","overlay"),this.$body=this.$table.append("g").attr("class","body").attr("transform","translate(0,"+this.config.htmlLayout.headerHeight+")"),this.$header=this.$table.append("g").attr("class","header"),this.$bodySVG=this.$headerSVG=this.$table,s=this.initScrolling(n(r.node()),this.config.htmlLayout.headerHeight)):(r.classed("lu-mode-separate",!0),this.$table=r,this.$headerSVG=this.$table.append("svg").attr("class","lu lu-header"),this.$headerSVG.attr("height",this.config.htmlLayout.headerHeight),this.$headerSVG.append("defs").attr("class","columnheader"),this.$header=this.$headerSVG.append("g"),this.$bodySVG=this.$table.append("div").attr("class","lu-wrapper").append("svg").attr("class","lu lu-body"),a=this.$bodySVG.append("defs"),a.append("defs").attr("class","column"),a.append("defs").attr("class","overlay"),this.$body=this.$bodySVG,s=this.initScrolling(n(r.node()).find("div.lu-wrapper"),0)),this.selectVisible=s.selectVisible,this.onScroll=s.onScroll,this.$header.append("rect").attr({width:"100%",height:this.config.htmlLayout.headerHeight,fill:"lightgray"}),this.$header.append("g").attr("class","main"),this.$header.append("g").attr("class","overlay"),this.headerUpdateRequired=!0,this.stackedColumnModified=null,this.dragWeight=this.initDragging(),this}t.prototype=r.prototype=n.extend(r.prototype,t.prototype),t.create=function(t,e,n){"storage"in t||(t={storage:t});var i=new r(t,e,n);return i.startVis(),i},t.prototype.scrolled=function(t,e){"combined"===this.config.svgLayout.mode?this.$header.attr("transform","translate(0,"+t+")"):this.$header.attr("transform","translate("+-e+",0)")},t.defaultConfig={colorMapping:e.map(),columnColors:e.scale.category20(),grayColor:"#999999",numberformat:e.format(".3n"),htmlLayout:{headerHeight:50,headerOffset:2,buttonTopPadding:10,labelLeftPadding:12,buttonRightPadding:15,buttonWidth:13},renderingOptions:{stacked:!1,values:!1,animation:!0,histograms:!1},svgLayout:{mode:"combined",rowHeight:20,rowPadding:.2,rowBarPadding:2,backupScrollRows:4,animationDuration:1e3,addPlusSigns:!1,plusSigns:{addStackedColumn:{title:"Add stacked column",action:"addNewEmptyStackedColumn",x:0,y:2,w:21,h:21}},rowActions:[]},manipulative:!0,interaction:{tooltips:!0,multiselect:function(){return!1},rangeselect:function(){return!1}},filter:{skip:0,limit:Number.POSITIVE_INFINITY,filter:i}},t.prototype.on=function(t,e){return arguments.length<2?this.listeners.on(t):(this.listeners.on(t,e),this)},t.prototype.changeDataStorage=function(t){this.storage=t.storage,this.storage.config=this.config,this.spec=t,this.config.columnBundles.primary.sortedColumn=null,this.headerUpdateRequired=!0,delete this.prevRowScale,this.startVis()},t.prototype.changeInteractionOption=function(t,e){var n=this.config.interaction[t];n!==e&&(this.config.interaction[t]=e)},t.prototype.changeRenderingOption=function(t,e){var n=this.config.renderingOptions[t];n!==e&&(this.config.renderingOptions[t]=e,"histograms"===t&&e&&this.storage.resortData({filteredChanged:!0}),this.updateAll(!0))},t.prototype.startVis=function(){this.assignColors(this.storage.getRawColumns()),this.headerUpdateRequired=!0,this.storage.resortData({}),this.updateAll()},t.prototype.assignColors=function(n){var i=this.config;i.colorMapping=e.map();var r=0;n.forEach(function(e){e.color?i.colorMapping.set(e.id,e.color):e instanceof t.LineUpStringColumn||"rank"===e.id?i.colorMapping.set(e.id,i.grayColor):(i.colorMapping.set(e.id,i.columnColors(r)),r++)})},t.prototype.updateAll=function(t,e){function n(e){var n=i.storage.getColumnLayout(e);i.updateHeader(n),i.updateBody(n,i.storage.getData(e),t||!1)}var i=this;e?n(e):Object.keys(this.storage.bundles).forEach(n)},t.prototype.sortBy=function(t,e){t=t||this.storage.primaryKey,e=e||!1;var n=this.storage.getColumnByName(t);if(!n)return!1;var i=this.config.columnBundles[n.columnBundle];i.sortingOrderAsc=e,i.sortedColumn=n,this.listeners["change-sortcriteria"](this,n,i.sortingOrderAsc),this.config.sorting&&this.config.sorting.external||this.storage.resortData({column:n,asc:i.sortingOrderAsc}),this.updateAll(!1,n.columnBundle)},t.prototype.toggleStackedRendering=function(){this.config.renderingOptions.stacked=!this.config.renderingOptions.stacked,this.updateAll(!0)},t.prototype.toggleValueRendering=function(){this.config.renderingOptions.values=!this.config.renderingOptions.values,this.updateAll(!0)},t.prototype.setLimits=function(t,e){this.config.filter.skip=t,this.config.filter.limit=e,this.storage.resortData({}),this.updateAll()},t.prototype.changeWeights=function(e,n){"string"==typeof e&&(e=this.storage.getColumnByName(e)),e=e||this.config.columnBundles.primary.sortedColumn;var i=e.columnBundle;return e instanceof t.LayoutStackedColumn?(e.updateWeights(n),e===this.config.columnBundles[i].sortedColumn&&(this.listeners["change-sortcriteria"](this,e,this.config.columnBundles[i]),this.config.sorting&&this.config.sorting.external||this.storage.resortData({key:i})),this.updateAll(!1,i),!0):!1},t.prototype.changeFilter=function(t,e){"string"==typeof t&&(t=this.storage.getColumnByName(t)),t.filter=e,this.listeners["change-filter"](this,t),this.config.filtering&&this.config.filtering.external||this.storage.resortData({filteredChanged:!0}),this.updateBody()},t.prototype.destroy=function(){this.tooltip.destroy(),this.$container.selectAll("*").remove(),"combined"===this.config.svgLayout.mode&&this.$container.off("scroll",this.onScroll)}}(i||(i={}),e,t);var i;!function(t,e,n,i,r){function o(t){return t.replace(/[\s!\'#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"_")}function a(t){this.column=t.column,this.label=t.label||t.column,this.color=t.color,this.id=o(t.id||this.column),this.missingValue=t.missingValue,this.layout={}}function s(t){return"number"!=typeof t||isNaN(t)}function l(t,n,i){a.call(this,t),this.domain=t.domain||[NaN,NaN],this.range=t.range||[0,1],"undefined"==typeof this.missingValue&&(this.missingValue=NaN);var r=this;if(s(this.domain[0])||s(this.domain[1])){var o=e.extent(i,function(t){return r.getValue(t)});s(this.domain[0])&&(this.domain[0]=o[0]),s(this.domain[1])&&(this.domain[1]=o[1])}}function u(t){a.call(this,t)}function c(t,n,i){a.call(this,t),this.categories=[],this.categoryColors=e.scale.category10().range();var r=this;t.categories&&t.categories.forEach(function(t,e){"string"==typeof t?r.categories.push(t):(r.categories.push(t.name),r.categoryColors[e]=t.color)}),0===this.categories.length&&(this.categories=e.set(i.map(function(t){return r.getValue(t)})).values(),this.categories.sort())}function h(t){var e=this;this.columnWidth=t.width||100,this.id=i.uniqueId("Column_"),this.filter=t.filter,this.parent=t.parent||null,this.columnBundle="primary",this.sortBy=function(t,n){return t=e.getValue(t),n=e.getValue(n),e.safeSortBy(t,n)}}function d(t,e){h.call(this,t),this.columnLink=t.column,this.column=e.get(t.column),this.id=o(i.uniqueId(this.columnLink+"_"))}function f(t,n){d.call(this,t,n),this.value2pixel=e.scale.linear().domain([0,1]).range([0,this.columnWidth]);var i=t.domain||this.column.domain;s(i[0])&&(i[0]=this.column.domain[0]),s(i[1])&&(i[1]=this.column.domain[1]),this.scale=e.scale.linear().clamp(!0).domain(i).range(t.range||this.column.range);var r=this;this.histgenerator=e.layout.histogram(),this.histgenerator.range(this.scale.range()),this.histgenerator.value(function(t){return r.getValue(t)}),this._hist=[]}function p(t,e){d.call(this,t,e)}function g(t,e){d.call(this,t,e)}function m(t,e){d.call(this,t,e)}function y(t,n,r,a){h.call(this,t?t:{},[]),this.columnWidth=t?t.width||50:50,this.id=o(i.uniqueId("rank_")),this.values=e.map(),this.storage=a}function v(t,e){h.call(this,t,e),this.childrenLinks=t.children||[],this.label=t.label||this.id}function C(t,n,i){v.call(this,t,n),this.childrenWeights=[],this.childrenWidths=[],this.toLayoutColumn=i,this.children=[],this.emptyColumns=[],this.scale=e.scale.linear().domain([0,1]).range([0,this.columnWidth]),this.init(t);var r=this;this.sortBy=function(t,e){var n=0,i=0;return r.children.forEach(function(r){n+=r.getWidth(t),i+=r.getWidth(e)}),r.safeSortBy(n,i)}}function b(t){h.call(this,t,[]),this.id=i.uniqueId("empty_"),this.label="{empty}",this.columnWidth=50}function x(t){t=t||{},h.call(this,t,[]),this.id=i.uniqueId("action_"),this.label="",this.columnWidth=t.width||50}t.LineUpColumn=a,a.prototype=n.extend({},{},{getValue:function(t){var e=t[this.column];return"undefined"==typeof e?this.missingValue:e},getRawValue:function(t){var e=this.getValue(t);return"undefined"==typeof e?"":e}}),t.LineUpNumberColumn=l,l.prototype=n.extend({},a.prototype,{getValue:function(t){var e=a.prototype.getValue.call(this,t);return null!==e&&"undefined"!=typeof e&&""!==e&&0!==e.toString().trim().length||(e=this.missingValue),+e},getRawValue:function(t){var e=a.prototype.getValue.call(this,t);return isNaN(e)?"":e}}),t.LineUpStringColumn=u,u.prototype=n.extend({},a.prototype,{}),t.LineUpCategoricalColumn=c,c.prototype=n.extend({},a.prototype,{}),t.LayoutColumn=h,h.prototype=n.extend({},{},{setColumnWidth:function(t,e){this.columnWidth=t,!e&&this.parent&&this.parent.updateWidthFromChild({id:this.id,newWidth:t})},getColumnWidth:function(){return this.columnWidth},prepare:function(){},safeSortBy:function(t,n){var i="number"==typeof t&&isNaN(t),r="number"==typeof n&&isNaN(n);return i&&r?0:i?1:r?-1:e.descending(t,n)},flattenMe:function(t){t.push(this)},description:function(){var t={};return t.width=this.columnWidth,t.filter=this.filter,t},makeCopy:function(){return new h(this.description())},isFiltered:function(){return"undefined"!=typeof this.filter},filterBy:function(){return!0}}),t.LayoutSingleColumn=d,d.prototype=n.extend({},h.prototype,{getValue:function(t,e){return"raw"===e?this.column.getRawValue(t):this.column.getValue(t)},getLabel:function(){return this.column.label},getDataID:function(){return this.column.id},description:function(){var t=h.prototype.description.call(this);return t.column=this.columnLink,t},makeCopy:function(){var t=this.description(),n=e.map();n.set(this.columnLink,this.column);var i=new d(t,n);return i}}),t.LayoutNumberColumn=f,f.prototype=n.extend({},d.prototype,{mapping:function(t){return arguments.length<1?this.scale:(this.scale=t.clamp(!0),void this.histgenerator.range(t.range()))},originalMapping:function(){return e.scale.linear().clamp(!0).domain(this.column.domain).range(this.column.range)},getHist:function(t){var e=this;this.histogramGetter?this.histogramGetter(this,function(n){t.call(e,n)}):setTimeout(function(){t.call(e,e._hist)},0)},prepare:function(t,n,i){if(this.histogramGetter=i,!n||i)return void(this._hist=[]);this._hist=this.histgenerator(t).map(function(t){return{x:t.x,dx:t.dx,y:t.y}});var r=e.max(this._hist,function(t){return t.y});this._hist.forEach(function(t){r>0?t.y/=r:t.y=0})},binOf:function(t,e){var n=this;this.getHist(function(i){var r,o=n.getValue(t);if(i)for(r=i.length-1;r>=0;--r){var a=i[r];if(a.x<=o&&o<=a.x+a.dx)return void e.call(n,r)}e.call(n,-1)})},setColumnWidth:function(t,e){this.value2pixel.range([0,t]),d.prototype.setColumnWidth.call(this,t,e)},getValue:function(t,e){return"raw"===e?this.column.getRawValue(t):this.scale(this.column.getValue(t))},getWidth:function(t){var e=this.getValue(t);return isNaN(e)||"undefined"==typeof e?0:this.value2pixel(e)},filterBy:function(t){var e=this.filter;if("undefined"==typeof e||!this.column)return!0;var n=this.getValue(t,"raw");return"number"==typeof e&&isNaN(e)?!isNaN(n):"number"==typeof e?n>=e:Array.isArray(e)?e[0]<=n&&n<=e[1]:!0},description:function(){var t=h.prototype.description.call(this);t.column=this.columnLink,t.type="number";var e=this.scale.domain(),n=this.column.domain;return e[0]===n[0]&&e[1]===n[1]||(t.domain=e),e=this.scale.range(),n=this.column.range,e[0]===n[0]&&e[1]===n[1]||(t.range=e),t},makeCopy:function(){var t=e.map();t.set(this.columnLink,this.column);var n=new f(this.description(),t);return n}}),t.LayoutStringColumn=p,p.prototype=n.extend({},d.prototype,{filterBy:function(t){var e=this.filter;if("undefined"==typeof e||!this.column)return!0;var n=this.getValue(t);return"boolean"==typeof n?n&&n.trim().length>0:"string"==typeof e&&e.length>0?n&&n.toLowerCase().indexOf(e.toLowerCase())>=0:e instanceof RegExp?n&&n.match(e):!0},makeCopy:function(){var t=e.map();t.set(this.columnLink,this.column);var n=new p(this.description(),t);return n}}),t.LayoutCategoricalColumn=g,g.prototype=n.extend({},d.prototype,{filterBy:function(t){var e=this.filter;if("undefined"==typeof e||!this.column)return!0;var n=this.getValue(t);return Array.isArray(e)&&e.length>0?e.indexOf(n)>=0:"string"==typeof e&&e.length>0?n&&n.toLowerCase().indexOf(e.toLowerCase())>=0:e instanceof RegExp?n&&n.match(e):!0},makeCopy:function(){var t=e.map();t.set(this.columnLink,this.column);var n=new g(this.description(),t);return n}}),t.LayoutCategoricalColorColumn=m,m.prototype=n.extend({},d.prototype,{getColor:function(t){var e=this.getValue(t,"raw");if(null===e||""===e)return null;var n=this.column.categories.indexOf(e);return 0>n?null:this.column.categoryColors[n]},filterBy:function(t){return g.prototype.filterBy.call(this,t)},makeCopy:function(){var t=e.map();t.set(this.columnLink,this.column);var n=new m(this.description(),t);return n}}),t.LayoutRankColumn=y,y.prototype=n.extend({},h.prototype,{setValue:function(t,e){this.values.set(t[this.storage.primaryKey],e)},getValue:function(t){return this.values.get(t[this.storage.primaryKey])},filter:function(t){var e=this.getValue(t);return"undefined"==typeof e?!0:"number"==typeof this.filter?e>=this.filter:Array.isArray(this.filter)?this.filter[0]<=e&&e<=this.filter[1]:!0},getLabel:function(){return"Rank"},getDataID:function(){return this.id},description:function(){var t=h.prototype.description.call(this);return t.type="rank",t},makeCopy:function(){var t=this.description(),e=new y(t,null,null,this.column.storage);return e}}),t.LayoutCompositeColumn=v,v.prototype=n.extend({},h.prototype,{getDataID:function(){return this.id},getLabel:function(){return this.label}}),t.LayoutStackedColumn=C,C.prototype=n.extend({},v.prototype,{getValue:function(t){var e=this,n=0;return this.children.forEach(function(i,r){var o=i.getValue(t);(isNaN(o)||"undefined"==typeof o)&&(o=0),n+=o*e.childrenWeights[r]}),n},init:function(t){var n=this;this.childrenLinks.length<1?this.emptyColumns.push(new b({parent:n})):(this.childrenLinks[0].hasOwnProperty("weight")?(this.childrenWeights=this.childrenLinks.map(function(t){return+(t.weight||1)}),this.scale.domain([0,e.sum(this.childrenWeights)]),t.hasOwnProperty("width")?this.childrenWidths=this.childrenWeights.map(function(t){return n.scale(t)}):(this.columnWidth=100*this.children.length,this.scale.range([0,n.columnWidth]))):(this.childrenWidths=this.childrenLinks.map(function(t){return+(t.width||100)}),this.childrenWeights=this.childrenWidths.map(function(t){return t/100}),this.columnWidth=e.sum(this.childrenWidths),this.scale.domain([0,e.sum(this.childrenWeights)]).range([0,this.columnWidth])),this.children=this.childrenLinks.map(function(t,e){return t.width=n.childrenWidths[e],t.parent=n,n.toLayoutColumn(t)}))},flattenMe:function(t,e){var n=!1;e&&(n=e.addEmptyColumns||!1),t.push(this),this.children.forEach(function(e){e.flattenMe(t)}),n&&this.emptyColumns.forEach(function(e){return e.flattenMe(t)})},filterBy:function(t){if("undefined"==typeof this.filter)return!0;var e=this.getValue(t);return"number"==typeof this.filter?e<=this.filter:Array.isArray(this.filter)?this.filter[0]<=e&&e<=this.filter[1]:!0},updateWidthFromChild:function(){var t=this;this.childrenWidths=this.children.map(function(t){return t.getColumnWidth()}),this.childrenWeights=this.childrenWidths.map(function(e){return t.scale.invert(e)}),this.columnWidth=e.sum(this.childrenWidths),this.scale.range([0,this.columnWidth]),this.scale.domain([0,e.sum(this.childrenWeights)])},setColumnWidth:function(t){var e=this;this.columnWidth=t,e.scale.range([0,this.columnWidth]),this.childrenWidths=this.childrenWeights.map(function(t){return e.scale(t)}),this.children.forEach(function(t,n){return t.setColumnWidth(e.childrenWidths[n],!0)})},updateWeights:function(t){this.childrenWeights=t,this.scale.domain([0,e.sum(this.childrenWeights)]);var n=this;this.childrenWidths=this.childrenWeights.map(function(t){return n.scale(t)}),this.columnWidth=e.sum(this.childrenWidths),this.children.forEach(function(t,e){return t.setColumnWidth(n.childrenWidths[e],!0)})},removeChild:function(n){var i=this.children.indexOf(n),r=this;this.childrenWeights.splice(i,1),this.childrenWidths.splice(i,1),this.columnWidth=e.sum(this.childrenWidths),this.scale.range([0,this.columnWidth]),this.scale.domain([0,e.sum(this.childrenWeights)]),this.children.splice(i,1),n.parent=null,this.children.length<1&&(this.emptyColumns=[new t.LayoutEmptyColumn({parent:r})],this.columnWidth=100)},addChild:function(n,i,r){if(!(n instanceof t.LayoutNumberColumn))return!1;var o=0;return i instanceof t.LayoutEmptyColumn?this.emptyColumns=[]:(o=this.children.indexOf(i),"r"===r&&o++),this.childrenWeights.splice(o,0,this.scale.invert(n.getColumnWidth())),this.childrenWidths.splice(o,0,n.getColumnWidth()),this.columnWidth=e.sum(this.childrenWidths),this.scale.range([0,this.columnWidth]),this.scale.domain([0,e.sum(this.childrenWeights)]),n.parent=this,this.children.splice(o,0,n),!0},description:function(){var t=h.prototype.description.call(this);t.type="stacked";var e=this;return t.children=this.children.map(function(t,n){var i=t.description();return i.weight=e.childrenWeights[n],i}),t.label=this.label,t},makeCopy:function(){var t=this,n=t.description();n.childrenLinks=[];var i=new C(n,{},t.toLayoutColumn);return i.children=t.children.map(function(t){return t.makeCopy()}),i.children.forEach(function(t){t.parent=i}),i.childrenWeights=this.childrenWeights.slice(0),i.scale.domain([0,e.sum(this.childrenWeights)]),i.childrenWidths=this.childrenWeights.map(function(e){return t.scale(e)}),i}}),t.LayoutEmptyColumn=b,b.prototype=n.extend({},h.prototype,{getLabel:function(){return this.label},getDataID:function(){return this.id},getValue:function(){return""}}),t.LayoutActionColumn=x,x.prototype=n.extend({},h.prototype,{getLabel:function(){return this.label},getDataID:function(){return this.id},description:function(){var t=h.prototype.description.call(this);return t.type="actions",t},getValue:function(){return""}})}(i||(i={}),e,t,n);var i;!function(t,e,n,i){function r(t,e,i,r){var o=400;r=n.extend({},r,{x:+t.node().clientWidth/2-o/2,y:0,width:o});var a=t.append("div").attr("class","lu-popupBG"),s=t.append("div").attr({"class":"lu-popup"}).style({left:r.x+"px",top:r.y+"px",width:r.width+"px"}).html('<span style="font-weight: bold">'+e+"</span>"+(i?'<input type="text" id="popupInputText" size="35" value="'+i+'"><br>':"")+'<div class="selectionTable"></div>'+'<button class="cancel"><i class="fa fa-times"></i> cancel</button>'+'<button class="ok"><i class="fa fa-check"></i> ok</button>'),l=s.select(".selectionTable").append("table");return s.select(".cancel").on("click",function(){a.remove(),s.remove()}),{popup:s,table:l,remove:function(){s.remove(),a.remove()},onOK:function(t){return s.select(".ok").on("click",t)}}}t.prototype=t.prototype||{},t.prototype.addNewStackedColumnDialog=function(){function e(){var t=a.table.selectAll("tr").data(s);t.select(".checkmark").html(function(t){return t.isChecked?'<i class="fa fa-check-square-o"></i>':'<i class="fa fa-square-o"></i>'}).on("click",function(t){t.isChecked=!t.isChecked,e()}),t.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"}),t.select(".weightInput").attr("disabled",function(t){return t.isChecked?null:!0})}function i(t){return n(o.$container.node()).find("#"+t)[0]}var o=this,a=r(this.$container,"Add stacked column:","Stacked"),s=o.storage.getRawColumns().filter(function(e){return e instanceof t.LineUpNumberColumn}).map(function(t){return{d:t,isChecked:!1,weight:1}}),l=a.table.selectAll("tr").data(s);l.enter().append("tr"),l.append("td").attr("class","checkmark"),l.append("td").attr("class","datalabel").style("opacity",.8).text(function(t){return t.d.label}),l.append("td").append("input").attr({"class":"weightInput",type:"text",value:function(t){return t.weight},disabled:!0,size:5}).on("input",function(t){t.weight=+this.value,e()}),e(),a.onOK(function(){var t=i("popupInputText").value;if(t.length<1)return void window.alert("name must not be empty");var e=s.filter(function(t){return t.isChecked}),n={label:t,width:Math.max(100*e.length,100),children:e.map(function(t){return{column:t.d.column,type:"number",weight:t.weight}})};o.storage.addStackedColumn(n),a.remove(),o.headerUpdateRequired=!0,o.listeners["columns-changed"](o),o.updateAll()})},t.prototype.addNewSingleColumnDialog=function(){function t(){var e=n.table.selectAll("tr").data(o);e.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}).on("click",function(e){e.isChecked=!e.isChecked,t()}),e.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}var e=this,n=r(this.$container,"add single columns",i),o=e.storage.getRawColumns().map(function(t){return{d:t,isChecked:!1,weight:1}}),a=n.table.selectAll("tr").data(o);a.enter().append("tr"),a.append("td").attr("class","checkmark"),a.append("td").attr("class","datalabel").style("opacity",.8).text(function(t){return t.d.label}),t(),n.onOK(function(){var t=o.filter(function(t){return t.isChecked});t.forEach(function(t){e.storage.addSingleColumn({column:t.d.column})}),n.remove(),t.length&&e.listeners["columns-changed"](e),e.headerUpdateRequired=!0,e.updateAll()})},t.prototype.reweightStackedColumnWidget=function(t,n){function i(){var i=n.selectAll("tr").data(t);o.domain([0,e.max(t,r)]),i.select(".predictBar").transition().style({width:function(t){return o(t.weight)+"px"}})}var r=function(t){return t.weight},o=e.scale.linear().domain([0,e.max(t,r)]).range([0,120]),a=n.selectAll("tr").data(t),s=this.config;a.enter().append("tr"),a.append("td").style({width:"20px"}).append("input").attr({"class":"weightInput",type:"text",value:function(t){return t.weight},size:5}).on("input",function(e){t[e.index].weight=+this.value,i()}),a.append("td").append("div").attr("class","predictBar").style({width:function(t){return o(t.weight)+"px"},height:20+"px","background-color":function(t){return s.colorMapping.get(t.dataID)}}),a.append("td").attr("class","datalabel").text(function(t){return t.d}),i()},t.prototype.reweightStackedColumnDialog=function(t){var e=this,n=r(this.$container,'re-weight column "'+t.label+'"',i),o=t.children.map(function(e,n){return{d:e.column.label,dataID:e.getDataID(),weight:+t.childrenWeights[n],index:n}});this.reweightStackedColumnWidget(o,n.table),n.onOK(function(){n.remove(),e.changeWeights(t,o.map(function(t){return t.weight}))})},t.prototype.openMappingEditor=function(e,r){function o(t){c=t,e.mapping(c);var n=g.node().checked;n?e.filter=t.domain():e.filter=i,r.classed("filtered",!a(c.range(),l.range())||!a(c.domain(),l.domain())),u.listeners["change-filter"](u,e),u.config.filtering&&u.config.filtering.external||u.storage.resortData({filteredChanged:!0}),u.updateAll(!0)}function a(t,e){return 0===n(t).not(e).length&&0===n(e).not(t).length}var s=e.mapping(),l=e.originalMapping(),u=this,c=s,h=this.$container.node().clientHeight,d=Math.max(270,Math.min(h/2,470)),f=this.$container.append("div").attr("class","lu-popupBG"),p=this.$container.append("div").attr({"class":"lu-popup"}).style({left:+this.$container.node().clientWidth/2-100+"px",top:"0px",width:d-50+"px",height:d+"px"}).html('<div style="font-weight: bold"> change mapping: </div>'+'<div class="mappingArea"></div>'+'<label><input type="checkbox" id="filterIt" value="filterIt">Filter Outliers</label><br>'+'<button class="cancel"><i class="fa fa-times"></i> cancel</button>'+'<button class="reset"><i class="fa fa-undo"></i> revert</button>'+'<button class="ok"><i class="fa fa-check"></i> ok</button>'),g=p.select("input").on("change",function(){o(c)});g.node().checked=Array.isArray(e.filter);var m=function(t){return+e.getValue(t,"raw")},y={callback:o,triggerCallback:"dragend",width:d-50,height:d-50},v=t.mappingEditor(s,l.domain(),u.storage.rawdata,m,y);p.select(".mappingArea").call(v),p.select(".ok").on("click",function(){o(c),p.remove(),f.remove()}),p.select(".cancel").on("click",function(){e.mapping(s),r.classed("filtered",!a(s.range(),l.range())||!a(s.domain(),l.domain())),p.remove(),f.remove()}),p.select(".reset").on("click",function(){c=s=l,o(l),v=t.mappingEditor(s,l.domain(),u.storage.rawdata,m,y),p.selectAll(".mappingArea *").remove(),p.select(".mappingArea").call(v)})},t.prototype.stackedColumnOptionsGui=function(t){function e(t){o.storage.removeColumn(t),o.listeners["columns-changed"](o),o.headerUpdateRequired=!0,o.updateAll()}function n(t){var e=+this.$container.node().clientWidth/2-100,n=0,i=this.$container.append("div").attr("class","lu-popupBG"),r=this.$container.append("div").attr({"class":"lu-popup"}).style({left:e+"px",top:n+"px",width:"200px",height:"70px"}).html('<div style="font-weight: bold"> rename column: </div>'+'<input type="text" id="popupInputText" size="20" value="'+t.label+'"><br>'+'<button class="cancel"><i class="fa fa-times"></i> cancel</button>'+'<button class="ok"><i class="fa fa-check"></i> ok</button>');r.select(".ok").on("click",function(){var e=document.getElementById("popupInputText").value;e.length>0?(t.label=e,o.updateHeader(o.storage.getColumnLayout(t.columnBundle)),r.remove(),i.remove()):window.alert("non empty string required")}),r.select(".cancel").on("click",function(){r.remove(),i.remove()})}var i=this.config,r=this.$header.select(".overlay"),o=this,a=this.stackedColumnModified===t;if(a)return r.selectAll(".stackedOption").remove(),void(this.stackedColumnModified=null);this.stackedColumnModified=t;var s=[{name:" remove",action:e},{name:" rename",action:n},{name:" re-weight",action:o.reweightStackedColumnDialog}],l=100*s.length,u=r.selectAll(".stackedOption").data([{d:t,o:s}]);u.exit().remove();var c=u.enter().append("g").attr({"class":"stackedOption",transform:function(t){return"translate("+(t.d.offsetX+t.d.columnWidth-l)+","+(i.htmlLayout.headerHeight/2-2)+")"}});c.append("rect").attr({x:0,y:0,width:l,height:i.htmlLayout.headerHeight/2-4}),c.selectAll("text").data(function(t){return t.o}).enter().append("text").attr({x:function(t,e){return 100*e+5},y:i.htmlLayout.headerHeight/4-2}).text(function(t){return t.name}),u.selectAll("text").on("click",function(e){r.selectAll(".stackedOption").remove(),e.action.call(o,t)}),u.transition().attr({transform:function(t){return"translate("+(t.d.offsetX+t.d.columnWidth-l)+","+(i.htmlLayout.headerHeight/2-2)+")"}})},t.prototype.openCategoricalFilterPopup=function(e,n){function i(){var t=s.select("tbody").selectAll("tr").data(u);t.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}).on("click",function(t){t.isChecked=!t.isChecked,i()}),t.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}function r(t){e.filter=t,n.classed("filtered",t&&t.length>0&&t.length<e.column.categories.length),l.listeners["change-filter"](l,e),l.config.filtering&&l.config.filtering.external||l.storage.resortData({filteredChanged:!0}),l.updateBody()}if(e instanceof t.LayoutCategoricalColumn){var o=e.filter||[],a=this.$container.append("div").attr("class","lu-popupBG"),s=this.$container.append("div").attr({"class":"lu-popup"}).style({left:+this.$container.node().clientWidth/2-100,
top:"0px",width:400+"px",height:300+"px"}).html('<span style="font-weight: bold">Edit Filter</span>'+'<form onsubmit="return false">'+'<div class="selectionTable"><table><thead><th></th><th>Category</th></thead><tbody></tbody></table></div>'+'<button class="ok"><i class="fa fa-check" title="ok"></i></button>'+'<button class="cancel"><i class="fa fa-times" title="cancel"></i></button>'+'<button class="reset"><i class="fa fa-undo" title="reset"></i></button></form>');s.select(".selectionTable").style({width:400-10+"px",height:300-40+"px"});var l=this,u=e.column.categories.map(function(t){return{d:t,isChecked:0===o.length||o.indexOf(t)>=0}}),c=s.select("tbody").selectAll("tr").data(u);c.enter().append("tr"),c.append("td").attr("class","checkmark"),c.append("td").attr("class","datalabel").text(function(t){return t.d}),i(),s.select(".cancel").on("click",function(){r(o),s.remove(),a.remove()}),s.select(".reset").on("click",function(){u.forEach(function(t){t.isChecked=!0}),i(),r(null)}),s.select(".ok").on("click",function(){var t=u.filter(function(t){return t.isChecked}).map(function(t){return t.d});t.length===e.column.categories.length&&(t=[]),r(t),s.remove(),a.remove()})}},t.prototype.openFilterPopup=function(e,i){function r(t){e.filter=t,i.classed("filtered",t&&t.length>0),c.listeners["change-filter"](c,e),c.config.filtering&&c.config.filtering.external||c.storage.resortData({filteredChanged:!0}),c.updateBody()}function o(t){return n(c.$container.node()).find("#"+t)[0]}if(e instanceof t.LayoutStringColumn){var a={left:e.offsetX,top:0},s=e.filter||"",l=this.$container.append("div").attr("class","lu-popupBG"),u=this.$container.append("div").attr({"class":"lu-popup2"}).style({left:a.left+"px",top:a.top+"px"}).html('<form onsubmit="return false"><input type="text" id="popupInputText" placeholder="containing..." autofocus="true" size="18" value="'+s+'"><br>'+'<button class="ok"><i class="fa fa-check" title="ok"></i></button>'+'<button class="cancel"><i class="fa fa-times" title="cancel"></i></button>'+'<button class="reset"><i class="fa fa-undo" title="reset"></i></button></form>'),c=this;u.select(".cancel").on("click",function(){o("popupInputText").value=s,r(s),u.remove(),l.remove()}),u.select(".reset").on("click",function(){o("popupInputText").value="",r(null)}),u.select(".ok").on("click",function(){r(o("popupInputText").value),u.remove(),l.remove()})}},t.createTooltip=function(t){function e(t,e){l.html(t).css({left:e.x+"px",top:e.y+e.height-s.offset().top+"px"}).fadeIn();var i=n(window).height()+n(window).scrollTop()<=e.y+e.height+l.height()-20,r=n(window).scrollTop()>e.y-l.height();i&&!r&&l.css("top",e.y-l.height()-s.offset().top+"px")}function i(){l.stop(!0).hide()}function r(t){t.x&&l.css({left:t.x+"px"}),t.y&&l.css({top:t.y-s.offset().top+"px"})}function o(){return[l.width(),l.height()]}function a(){l.remove()}var s=n(t),l=n('<div class="lu-tooltip"/>').appendTo(s);return{show:e,hide:i,move:r,size:o,destroy:a}},t.prototype.initScrolling=function(t,e){function i(){var t=s.scrollTop,e=s.scrollLeft;a.scrolled(t,e),Math.abs(u-t)>=l*(h/2)&&(u=t,a.updateBody())}function r(e,n){var i,r=s.scrollTop-o,a=r+t.innerHeight(),u=0;if(r>0){for(u=Math.round(r/l);u>=0&&n(e[u+1])>r;)u--;u-=h}for(i=Math.round(a/l);i<=e.length&&n(e[i-1])<a;)i++;return i+=h,[Math.max(u,0),Math.min(i,e.length)]}var o,a=this,s=t[0],l=this.config.svgLayout.rowHeight,u=s.scrollTop,c=n(this.$table.node()),h=this.config.svgLayout.backupScrollRows;return t.on("scroll",i),o=c.offset().top-t.offset().top+e,{selectVisible:r,onScroll:i}},t.prototype.initDragging=function(){function n(){e.event.sourceEvent.stopPropagation(),e.select(this).classed("dragging",!0)}function i(){var t=Math.max(e.mouse(this.parentNode)[0],2);o.reweightHeader({column:e.select(this).data()[0],value:t}),o.updateBody(o.storage.getColumnLayout(),o.storage.getData(),!1)}function r(){e.select(this).classed("dragging",!1),o.config.columnBundles.primary.sortedColumn instanceof t.LayoutStackedColumn&&(o.listeners["change-sortcriteria"](o,o.config.columnBundles.primary.sortedColumn),o.config.sorting&&o.config.sorting.external||o.storage.resortData({column:o.config.columnBundles.primary.sortedColumn}),o.updateBody(o.storage.getColumnLayout(),o.storage.getData(),!1))}var o=this;return e.behavior.drag().origin(function(t){return t}).on("dragstart",n).on("drag",i).on("dragend",r)}}(i||(i={}),e,t);var i;!function(t,e,n){"use strict";function i(t,e,n,i,r,o){return t.append("line").attr({x1:e,y1:n,x2:i,y2:r,"class":o})}function r(t,e,n,i,r,o){return r=r||null,o=o||null,t.append("text").attr({x:e,y:n,dy:r,"class":o}).text(i)}function o(t,e,n,i,r){return n-=e,t.append("circle").attr({"class":"handle",r:r,cx:e,cy:i,transform:"translate("+n+",0)"})}t.mappingEditor=function(t,a,s,l,u){u=n.extend({width:400,height:400,padding:50,radius:10,callback:n.noop,callbackThisArg:null,triggerCallback:"change"},u);var c=function(n){function c(t,n){return e.behavior.drag().on("dragstart",function(){e.select(this).classed("dragging",!0).attr("r",1.1*u.radius),t.style("visibility","visible")}).on("drag",n).on("dragend",function(){e.select(this).classed("dragging",!1).attr("r",u.radius),t.style("visibility",null),f(!0)}).origin(function(){var t=e.transform(e.select(this).attr("transform"));return{x:t.translate[0],y:t.translate[1]}})}function h(){t.range([x,w]),A.attr("x1",function(e){return t(l(e))}),f()}function d(){var e,n;L>k?(e=A.filter(function(t){return C(l(t))<k||C(l(t))>L}),n=A.filter(function(t){return!(C(l(t))<k||C(l(t))>L)})):(e=A.filter(function(t){return C(l(t))>k||C(l(t))<L}),n=A.filter(function(t){return!(C(l(t))>k||C(l(t))<L)})),e.style("visibility","hidden"),t.domain([C.invert(k),C.invert(L)]),n.style("visibility",null).attr("x1",function(e){return t(l(e))}),f()}function f(t){if(t===("dragend"===u.triggerCallback)){var n=e.scale.linear().domain([C.invert(k),C.invert(L)]).range([b.invert(x),b.invert(w)]);u.callback.call(u.callbackThisArg,n)}}var p=n.append("svg").attr({"class":"lugui-me",width:u.width,height:u.height}),g=u.padding,m=u.width-u.padding,y=u.padding,v=u.height-u.padding,C=e.scale.linear().domain(a).range([g,m]),b=e.scale.linear().domain([0,1]).range([g,m]),x=b(t.range()[0]),w=b(t.range()[1]),k=C(t.domain()[0]),L=C(t.domain()[1]);t=e.scale.linear().clamp(!0).domain(t.domain()).range([x,w]);var S=p.append("g");i(S,g,y,m,y,"axis"),r(S,g,y-25,0,".75em"),r(S,m,y-25,1,".75em"),r(S,u.width/2,y-25,"Score",".75em","centered"),i(S,g,v,m,v,"axis"),r(S,g,v+20,a[0],".75em"),r(S,m,v+20,a[1],".75em"),r(S,u.width/2,v+20,"Raw",".75em","centered");var A=p.append("g").classed("data",!0).selectAll("line").data(s);A.enter().append("line").attr({x1:function(e){return t(l(e))},y1:y,x2:function(t){return C(l(t))},y2:v}).style("visibility",function(t){var e;return e=L>k?C(l(t))<k||C(l(t))>L:C(l(t))>k||C(l(t))<L,e?"hidden":null});var _=i(p,x,y,k,v,"bound"),E=i(p,w,y,L,v,"bound"),O=r(p,g+5,y-15,e.round(b.invert(x),2),".25em","drag").attr("transform","translate("+(x-g)+",0)"),D=r(p,g+5,v-15,e.round(C.invert(k),2),".25em","drag").attr("transform","translate("+(k-g)+",0)"),W=r(p,m+5,y-15,e.round(b.invert(w),2),".25em","drag").attr("transform","translate("+(w-m)+",0)"),N=r(p,m+5,v-15,e.round(C.invert(L),2),".25em","drag").attr("transform","translate("+(L-m)+",0)");o(p,g,x,y,u.radius).call(c(O,function(){e.event.x>=0&&e.event.x<=m-g&&(_.attr("x1",g+e.event.x),e.select(this).attr("transform","translate("+e.event.x+", 0)"),x=e.event.x+g,O.text(e.round(b.invert(x),2)).attr("transform","translate("+e.event.x+", 0)"),h())})),o(p,m,w,y,u.radius).call(c(W,function(){e.event.x>=-1*(m-g)&&e.event.x<=0&&(E.attr("x1",m+e.event.x),e.select(this).attr("transform","translate("+e.event.x+", 0)"),w=e.event.x+m,W.text(e.round(b.invert(w),2)).attr("transform","translate("+e.event.x+", 0)"),h())})),o(p,g,k,v,u.radius).call(c(D,function(){e.event.x>=0&&e.event.x<=m-g&&(_.attr("x2",g+e.event.x),e.select(this).attr("transform","translate("+e.event.x+", 0)"),k=e.event.x+g,D.text(e.round(C.invert(k),2)).attr("transform","translate("+e.event.x+", 0)"),d())})),o(p,m,L,v,u.radius).call(c(N,function(){e.event.x>=-1*(m-g)&&e.event.x<=0&&(E.attr("x2",m+e.event.x),e.select(this).attr("transform","translate("+e.event.x+", 0)"),L=e.event.x+m,N.text(e.round(C.invert(L),2)).attr("transform","translate("+e.event.x+", 0)"),d())}))};return c}}(i||(i={}),e,t);var i;!function(t,e,n,i,r){function o(e){return function n(i){i.columnBundle=e,i instanceof t.LayoutStackedColumn&&i.children.forEach(n)}}function a(i,r,o,s,l){function u(t){return new h[t.type](t,u,i)}function c(e){var n=e.type||"single";if("single"===n){var i=p.get(e.column);i instanceof t.LineUpNumberColumn?n="number":i instanceof t.LineUpCategoricalColumn&&(n="categorical")}return new d[n](e,p,c,f)}this.storageConfig=n.extend(!0,{},{colTypes:{number:t.LineUpNumberColumn,string:t.LineUpStringColumn,categorical:t.LineUpCategoricalColumn},layoutColumnTypes:{number:t.LayoutNumberColumn,single:t.LayoutStringColumn,string:t.LayoutStringColumn,categorical:t.LayoutCategoricalColumn,categoricalcolor:t.LayoutCategoricalColorColumn,stacked:t.LayoutStackedColumn,rank:t.LayoutRankColumn,actions:t.LayoutActionColumn}},l),this.config=null;var h=this.storageConfig.colTypes,d=this.storageConfig.layoutColumnTypes,f=this;this.storageConfig.toColumn=u,this.primaryKey=s,this.rawdata=i,this.selected=e.set(),this.rawcols=r.map(u),this.layout=o||a.generateDefaultLayout(this.rawcols);var p=e.map();this.rawcols.forEach(function(t){p.set(t.column,t)}),this.storageConfig.toLayoutColumn=c;var g=this.bundles={};Object.keys(this.layout).forEach(function(t){g[t]={layoutColumns:[],needsLayout:!0,data:i,initialSort:!0}})}t.LineUpLocalStorage=a,t.createLocalStorage=function(t,e,n,i,r){return new a(t,e,n,i,r)},a.generateDefaultLayout=function(e){var n=e.map(function(e){return{column:e.column,width:e instanceof t.LineUpStringColumn?200:100}});return{primary:n}},a.prototype=n.extend({},{},{getRawColumns:function(){return this.rawcols},getColumnLayout:function(t){var e=t||"primary";return this.bundles[e].needsLayout&&(this.generateLayout(this.layout,e),this.bundles[e].needsLayout=!1),this.bundles[e].layoutColumns},isSelected:function(t){return this.selected.has(t[this.primaryKey])},select:function(t){this.selected.add(t[this.primaryKey])},selectAll:function(t){var e=this;t.forEach(function(t){e.selected.add(t[e.primaryKey])})},setSelection:function(t){this.clearSelection(),this.selectAll(t)},deselect:function(t){this.selected.remove(t[this.primaryKey])},selectedRows:function(){return this.rawdata.filter(this.isSelected.bind(this))},clearSelection:function(){this.selected=e.set()},getData:function(t){return t=t||"primary",this.bundles[t].data},filterData:function(t){var e=[];return t.forEach(function(t){t.flattenMe(e)}),e=e.filter(function(t){return t.isFiltered()}),n.isFunction(this.config.filter.filter)&&e.push(this.config.filter.filter),0===e.length?this.rawdata:this.rawdata.filter(function(t){return e.every(function(e){return e.filterBy(t)})})},resortData:function(n){function i(t,n){var i=l.sortBy(t,n);return 0===i||isNaN(i)?e.ascending(t[d],n[d]):s?-i:i}var r=n.key||"primary",o=this,a=this.bundles[r],s=n.asc||this.config.columnBundles[r].sortingOrderAsc,l=n.column||this.config.columnBundles[r].sortedColumn,u=this.getColumnLayout(r);if(a.data=this.filterData(u),n.filteredChanged||a.initialSort){var c=[];u.forEach(function(t){t.flattenMe(c)});var h=o.config.histograms&&o.config.histograms.generator;c.forEach(function(t){t.prepare(a.data,o.config.renderingOptions.histograms,h)}),a.initialSort=!1}var d=this.primaryKey;l&&a.data.sort(i);var f=this.config.filter.skip?this.config.filter.skip:0;this.config.filter.limit&&isFinite(this.config.filter.limit)?a.data=a.data.slice(f,f+this.config.filter.limit):a.data=a.data.slice(f);var p=a.layoutColumns.filter(function(e){return e instanceof t.LayoutRankColumn});if(p.length>0){var g=function(t,e){return e};l&&(g=function(t){return l.getValue(t)}),this.assignRanks(a.data,g,p)}},assignRanks:function(t,e,n){var i=1,r=-1;t.forEach(function(t,o){r===-1&&(r=e(t,o)),r!==e(t,o)&&(i=o+1,r=e(t,o)),n.forEach(function(e){e.setValue(t,i)})})},generateLayout:function(e,n){var i=n||"primary",r=this.bundles[i];r.layoutColumns=e[i].map(this.storageConfig.toLayoutColumn),r.layoutColumns.filter(function(e){return e instanceof t.LayoutRankColumn}).length<1&&r.layoutColumns.unshift(new t.LayoutRankColumn(null,null,null,this)),this.config.svgLayout.rowActions.length>0&&r.layoutColumns.filter(function(e){return e instanceof t.LayoutActionColumn}).length<1&&r.layoutColumns.push(new t.LayoutActionColumn),r.layoutColumns.forEach(o(i))},addColumn:function(e,n,i){var r,o,a=n||"primary",s=this.bundles[a].layoutColumns;if("undefined"==typeof i||null===i)for(r=0;r<s.length&&(o=s[r],o instanceof t.LayoutRankColumn||o instanceof t.LayoutStringColumn);++r);else 0>i&&(i=s.length+1+i),r=Math.max(0,Math.min(s.length,i));e.columnBundle=a,s.splice(r,0,e)},addStackedColumn:function(t,e,i){var r=n.extend({type:"stacked",label:"Stacked",children:[]},t);this.addColumn(this.storageConfig.toLayoutColumn(r),i,e)},addSingleColumn:function(t,e,n){this.addColumn(this.storageConfig.toLayoutColumn(t),n,e)},removeColumn:function(e){var n=this.bundles[e.columnBundle].layoutColumns;if(e instanceof t.LayoutStackedColumn){var o=i.indexOf(n,e);if(o!==r){var a=[];Array.prototype.splice.apply(n,[o,1].concat(a))}}else e.column&&(null===e.parent||e.parent===r?n.splice(n.indexOf(e),1):(e.parent.removeChild(e),this.resortData({})))},moveColumn:function(t,e,n){var i,r=this.bundles[t.columnBundle].layoutColumns,a=this.bundles[e.columnBundle].layoutColumns;null==t.parent&&null==e.parent?(r.splice(r.indexOf(t),1),i=a.indexOf(e),"r"===n&&i++,a.splice(i,0,t)):null!==t.parent&&null===e.parent?(t.parent.removeChild(t),i=a.indexOf(e),"r"===n&&i++,a.splice(i,0,t)):null===t.parent&&null!==e.parent?e.parent.addChild(t,e,n)&&r.splice(r.indexOf(t),1):null!==t.parent&&null!==e.parent&&(t.parent.removeChild(t),e.parent.addChild(t,e,n)),o(e.columnBundle)(t),this.resortData({})},copyColumn:function(t,e,n){var i=this.bundles[e.columnBundle].layoutColumns,r=t.makeCopy();if(o(e.columnBundle)(r),null==e.parent){var a=i.indexOf(e);"r"===n&&a++,i.splice(a,0,r)}else null!==e.parent&&e.parent.addChild(r,e,n);this.resortData({})},getColumnByName:function(t){for(var e=this.getColumnLayout(),n=e.length-1;n>=0;--n){var i=e[n];if(i.getLabel()===t||i.column&&i.column.column===t)return i}return null}})}(i||(i={}),e,t,n);var i;!function(t,e,n,i){function r(e,n,i,r,o){var a=e.filter(function(e){return e instanceof t.LayoutCategoricalColumn||e instanceof t.LayoutStringColumn||e instanceof t.LayoutRankColumn}),s=r.svgLayout.rowHeight/2,l=n.selectAll(".tableData.text").data(function(e){var n=a.map(function(n){return{value:n.getValue(e),label:n.getValue(e,"raw"),offsetX:n.offsetX,columnW:n.getColumnWidth(),isRank:n instanceof t.LayoutRankColumn,clip:"url("+o+"#clip-B"+n.id+")"}});return n});l.enter().append("text").attr({"class":function(t){return"tableData text"+(t.isRank?" rank":"")},y:s,"clip-path":function(t){return t.clip}}),l.exit().remove(),l.attr("x",function(t){return t.offsetX}).attr({"clip-path":function(t){return t.clip}}).text(function(t){return t.label}),n.selectAll(".tableData.text.rank").text(function(t){return t.label})}function o(e,n,i,r){var o=e.filter(function(e){return e instanceof t.LayoutCategoricalColorColumn}),a=r.svgLayout.rowHeight-2*r.svgLayout.rowBarPadding,s=n.selectAll(".tableData.cat").data(function(t){var e=o.map(function(e){return{value:e.getValue(t),label:e.getValue(t,"raw"),offsetX:e.offsetX,columnW:e.getColumnWidth(),color:e.getColor(t),clip:"url(#clip-B"+e.id+")"}});return e});s.enter().append("rect").attr({"class":"tableData cat",y:r.svgLayout.rowBarPadding,height:r.svgLayout.rowHeight-2*r.svgLayout.rowBarPadding,width:a}).append("title"),s.exit().remove(),s.attr("x",function(t){return t.offsetX+2}).style("fill",function(t){return t.color}).select("title").text(function(t){return t.label})}function a(e){if(!e.renderingOptions.stacked||e.renderingOptions.values)return!1;var n=e.columnBundles.primary.sortedColumn;return!(n&&n.parent instanceof t.LayoutStackedColumn)}function s(e,n,i){var r=e.filter(function(e){return e.column instanceof t.LineUpNumberColumn}),o=n.selectAll(".tableData.bar").data(function(t){var e=r.map(function(e){return{key:e.getDataID(),value:e.getWidth(t),label:e.column.getRawValue(t),offsetX:e.offsetX}});return e});o.enter().append("rect").attr({"class":"tableData bar",y:i.svgLayout.rowBarPadding,height:i.svgLayout.rowHeight-2*i.svgLayout.rowBarPadding}),o.exit().remove(),o.attr({x:function(t){return t.offsetX},width:function(t){return Math.max(+t.value-2,0)}}).style({fill:function(t){return i.colorMapping.get(t.key)}})}function l(e,n,i,r){var o=e.filter(function(e){return e instanceof t.LayoutStackedColumn}),s=n.selectAll(".tableData.stacked").data(function(t){var e=o.map(function(e){return{key:e.getDataID(),childs:e.children,parent:e,row:t}});return e});s.exit().remove(),s.enter().append("g").attr("class","tableData stacked"),s.attr("transform",function(t){return"translate("+t.parent.offsetX+","+0+")"});var l=0,u=0,c={},h=a(r),d=s.selectAll("rect").data(function(t){return l=0,u=0,t.childs.map(function(e){return u=e.getWidth(t.row),c={child:e,width:u,offsetX:l},l+=h?u:e.getColumnWidth(),c})});d.exit().remove(),d.enter().append("rect").attr({y:r.svgLayout.rowBarPadding,height:r.svgLayout.rowHeight-2*r.svgLayout.rowBarPadding}),(i?d.transition(r.svgLayout.animationDuration):d).attr({x:function(t){return t.offsetX},width:function(t){return t.width>2?t.width-2:t.width}}).style({fill:function(t){return r.colorMapping.get(t.child.getDataID())}})}function u(t,e,n){var i=t.selectAll("text").data(n.svgLayout.rowActions);i.enter().append("text").append("title"),i.exit().remove(),i.attr("x",function(t,e){return e*n.svgLayout.rowHeight}).text(function(t){return t.icon}).on("click",function(t){t.action.call(this,e.data,t)}).select("title").text(function(t){return t.name})}function c(n,i,r){var o=n.filter(function(e){return e instanceof t.LayoutActionColumn}),a=i.selectAll(".tableData.action").data(function(t){var e=o.map(function(e){return{key:e.getDataID(),value:e.getColumnWidth(t),data:t,offsetX:e.offsetX}});return e});a.enter().append("g").attr("class","tableData action").each(function(t){u(e.select(this),t,r)}),a.exit().remove(),a.attr("transform",function(t){return"translate("+(t.offsetX+10)+","+(.5*r.svgLayout.rowHeight+1)+")"})}function h(e,n){var i=e.getValue(n,"raw");return(e instanceof t.LayoutNumberColumn||e instanceof t.LayoutStackedColumn)&&(i=null===i||"undefined"==typeof i?0:isNaN(i)||""===i.toString()?"":+i),i}function d(t,e,i){var r=n("<div><table><thead><tr><th>Column</th><th>Value</th></tr></thead><tbody></tbody></table></div>"),o=r.find("tbody");return e.forEach(function(e){var r=h(e,t);"undefined"==typeof r?r="":"number"==typeof r&&(r=i.numberformat(r)),n("<tr><th>"+e.getLabel()+"</th><td>"+r+"</td></tr>").appendTo(o)}),r.html()}t.prototype=t.prototype||{},t.updateClipPaths=function(t,e,n,i,r){r=r||"column";var o=e.select("defs."+r).selectAll(function(){return this.getElementsByTagName("clipPath")}).data(t,function(t){return t.id});o.enter().append("clipPath").attr("id",function(t){return"clip-"+n+t.id}).append("rect").attr({y:0,height:"1000"}),o.exit().remove(),o.select("rect").attr({x:function(t){return i?t.offsetX:null},width:function(t){return Math.max(t.getColumnWidth()-5,0)}})},t.prototype.select=function(t){var e=this.storage.primaryKey,n=this.$body.selectAll(".row");Array.isArray(t)?(this.storage.setSelection(t),t=t.map(function(t){return t[e]}),n.classed("selected",function(n){return t.indexOf(n[e])>=0})):t?(this.storage.setSelection([t]),n.classed("selected",function(n){return n[e]===t[e]})):(this.storage.clearSelection(),n.classed("selected",!1))},t.prototype.updateBody=function(n,i,u){function h(e){function i(t){return isNaN(t)||""===t||"undefined"==typeof t?"":g.config.numberformat(+t)}var r=[];return n.forEach(function(n){if(n.column instanceof t.LineUpNumberColumn)r.push({id:n.id,value:n.getValue(e),label:g.config.numberformat(+n.getValue(e,"raw")),x:n.offsetX,w:n.getColumnWidth()});else if(n instanceof t.LayoutStackedColumn){var o=0;n.children.forEach(function(t){var a=t.getWidth(e);r.push({id:t.id,label:i(t.getValue(e,"raw"))+" -> ("+y(t.getWidth(e))+")",w:E?a:t.getColumnWidth(),x:o+n.offsetX}),o+=E?a:t.getColumnWidth()})}}),r}function f(t,e,n,i,r){t.selectAll("text."+n).data(e).enter().append("text").attr({"class":"tableData "+n,x:function(t){return t.x},y:g.config.svgLayout.rowHeight/2,"clip-path":function(t){return"url("+(r||"")+"#clip-"+i+t.id+")"}}).text(function(t){return t.label})}if(!Array.isArray(n)||0!==n.length){n=n||this.storage.getColumnLayout(),i=i||this.storage.getData(n[0].columnBundle),u=u||!1;var p=this.$body,g=this,m=this.storage.primaryKey,y=e.format(".1f"),v=this.config.columnBundles[n[0].columnBundle];u=u||!1;var C=[];n.forEach(function(t){t.flattenMe(C)});var b=i.length,x=i,w=e.scale.ordinal().domain(i.map(function(t){var e=t[m];return null===e||"undefined"==typeof e?"":e})).rangeBands([0,b*g.config.svgLayout.rowHeight],0,g.config.svgLayout.rowPadding),k=v.prevRowScale||w;v.prevRowScale=w;var L=0;"combined"===g.config.svgLayout.mode&&(L=g.config.htmlLayout.headerHeight),this.$bodySVG.attr("height",b*g.config.svgLayout.rowHeight+L);var S=this.selectVisible(i,w);(S[0]>0||S[1]<i.length)&&(i=i.slice(S[0],S[1]));var A=p.selectAll(".row").data(i,function(t){return t[m]});A.exit().remove();var _=A.enter().append("g").attr({"class":"row",transform:function(t){var e=k(t[m]);if("undefined"==typeof e){var n=w.range();e=n&&n.length>0?n[n.length-1]:0}return"translate("+0+","+e+")"}});_.append("rect").attr({"class":"filler",width:"100%",height:g.config.svgLayout.rowHeight}),(this.config.renderingOptions.animation?A.transition().duration(this.config.svgLayout.animationDuration):A).attr({transform:function(t){var e=t[m];return"translate("+0+","+(null===e||"undefined"==typeof e?0:w(e))+")"}});var E=a(this.config);A.on({mouseenter:function(t){function n(t){var e=document.documentElement.scrollTop||document.body.scrollTop,n=t.getScreenCTM(),i=t.getBBox(),r=g.$bodySVG.node().createSVGPoint();return r.x=i.x,r.y=i.y,r=r.matrixTransform(n),e+r.y}var i=e.select(this);i.classed("hover",!0);var r=h(t),o=w(t[m]),a=g.$bodySVG.select("defs.overlay").selectAll(function(){return this.getElementsByTagName("clipPath")}).data(r);a.enter().append("clipPath").append("rect").attr({height:"1000"}),a.exit().remove(),a.attr("y",o).attr("id",function(t){return"clip-M"+t.id}),a.select("rect").attr({x:function(t){return t.x},width:function(t){return Math.max(t.w-2,0)}}),f(i,r,"hoveronly","M",g.getClipSource.apply(this)),g.config.interaction.tooltips&&g.tooltip.show(d(t,C,g.config),{x:e.mouse(g.$container.node())[0]+10,y:n(this),height:g.config.svgLayout.rowHeight}),g.hoverHistogramBin(t),g.listeners.hover(t,o)},mousemove:function(){g.config.interaction.tooltips&&g.tooltip.move({x:e.mouse(g.$container.node())[0]})},mouseleave:function(){g.config.interaction.tooltips&&g.tooltip.hide(),g.hoverHistogramBin(null),g.listeners.hover(null),e.select(this).classed("hover",!1),e.select(this).selectAll("text.hoveronly").remove()},click:function(t){var n=e.select(this),i=g.storage.isSelected(t);if(g.config.interaction.multiselect(e.event)){var r=g.storage.selectedRows();if(i)n.classed("selected",!1),g.storage.deselect(t),1===r.length&&g.listeners.selected(null),r.splice(r.indexOf(t),1);else{if(n.classed("selected",!0),g.storage.select(t),g.config.interaction.rangeselect(e.event)&&1===r.length){var o=x.indexOf(t),a=x.indexOf(r[0]);r=a>o?x.slice(o,a+1):x.slice(a,o+1);var s=A.filter(function(t){return r.indexOf(t)>=0}).classed("selected",!0).data();g.storage.selectAll(s)}else r.push(t);1===r.length&&g.listeners.selected(t,null)}g.listeners.multiselected(r)}else if(i)n.classed("selected",!1),g.storage.deselect(t),g.listeners.selected(null),g.listeners.multiselected([]);else{var l=A.filter(".selected").classed("selected",!1);l=l.empty?null:l.datum(),n.classed("selected",!0),g.storage.setSelection([t]),g.listeners.selected(t,l),g.listeners.multiselected([t])}}});var O=A;s(n,O,g.config),l(n,O,this.config.renderingOptions.animation&&u,g.config),c(n,O,g.config),t.updateClipPaths(C,this.$bodySVG,"B",!0);var D=g.getClipSource.apply(this.$container[0][0]);r(C,O,p,g.config,D),o(C,O,p,g.config),g.config.renderingOptions.values?(A.classed("values",!0),A.each(function(t){var n=e.select(this);f(n,h(t),"valueonly","B",D)})):A.classed("values",!1).selectAll("text.valueonly").remove(),A.classed("selected",function(t){return g.storage.isSelected(t)})}}}(i||(i={}),e,t);var i;return function(t,e,n,i){t.prototype=t.prototype||{},t.prototype.layoutHeaders=function(n){var i=0,r=this.config,o=r.htmlLayout.headerHeight,a=r.htmlLayout.headerOffset;n.forEach(function(t){t.offsetX=i,t.offsetY=a,t.height=o-2*a,i+=t.getColumnWidth()});var s=i+4;e.values(r.svgLayout.plusSigns).forEach(function(t){t.x=s,s+=t.w+4}),n.filter(function(e){return e instanceof t.LayoutStackedColumn}).forEach(function(t){t.height=o/2-2*a;var e=0,n=t.offsetX,i=t.children.concat(t.emptyColumns);i.map(function(t){t.offsetX=n+e,t.localOffsetX=e,e+=t.getColumnWidth(),t.offsetY=o/2+a,t.height=o/2-2*a})}),this.totalWidth=s},t.prototype.updateHeader=function(i){if(!Array.isArray(i)||0!==i.length){i=i||this.storage.getColumnLayout();var r=this.$header,o=r.select("g.main"),a=this,s=this.config;this.headerUpdateRequired&&(this.layoutHeaders(i),this.$headerSVG.attr("width",this.totalWidth),this.$bodySVG.attr("width",this.totalWidth),this.headerUpdateRequired=!1);var l=[];i.forEach(function(t){t.flattenMe(l,{addEmptyColumns:!0})}),l.reverse(),t.updateClipPaths(l,this.$headerSVG,"H",!1,"columnheader");var u=o.selectAll(".header").data(l,function(t){return t.id});u.exit().remove();var c=u.enter().append("g").attr("class","header").classed("emptyHeader",function(e){return e instanceof t.LayoutEmptyColumn||e instanceof t.LayoutActionColumn}).classed("nestedHeader",function(e){return e&&e.parent instanceof t.LayoutStackedColumn}).call(function(){a.addResortDragging(this,s)});u.attr("transform",function(t){return"translate("+t.offsetX+","+t.offsetY+")"}),c.append("rect").attr({"class":"labelBG",y:0}).style("fill",function(e){return e instanceof t.LayoutEmptyColumn?"lightgray":e.column&&s.colorMapping.has(e.column.id)?s.colorMapping.get(e.column.id):s.grayColor}).on("click",function(n){if(!(e.event.defaultPrevented||n instanceof t.LayoutEmptyColumn||n instanceof t.LayoutActionColumn||n instanceof t.LayoutRankColumn||n instanceof t.LayoutStackedColumn&&n.children.length<1)){var i=s.columnBundles[n.columnBundle];null!==i.sortedColumn&&n===i.sortedColumn?i.sortingOrderAsc=!i.sortingOrderAsc:i.sortingOrderAsc=n instanceof t.LayoutStringColumn||n instanceof t.LayoutCategoricalColumn||n instanceof t.LayoutRankColumn,i.sortedColumn=n,a.listeners["change-sortcriteria"](this,n,i.sortingOrderAsc),a.config.sorting&&a.config.sorting.external||a.storage.resortData({column:n,asc:i.sortingOrderAsc}),a.updateAll(!1)}}),u.select(".labelBG").attr({width:function(t){return Math.max(t.getColumnWidth()-5,0)},height:function(t){return t.height}}),c.append("g").attr("class","hist");var h=u.filter(function(e){return e instanceof t.LayoutNumberColumn});this.config.renderingOptions.histograms?h.selectAll("g.hist").each(function(t){var n=e.select(this).attr("transform","scale(1,"+t.height+")");t.getHist(function(e){if(e){var i=t.value2pixel.copy().range([0,t.value2pixel.range()[1]-5]),r=n.selectAll("rect").data(e);r.enter().append("rect"),r.attr({x:function(t){return i(t.x)},width:function(t){return i(t.dx)},y:function(t){return 1-t.y},height:function(t){return t.y}})}})}):h.selectAll("g.hist").selectAll("*").remove(),this.config.manipulative&&(c.filter(function(e){return!(e instanceof t.LayoutEmptyColumn||e instanceof t.LayoutActionColumn)}).append("rect").attr({"class":"weightHandle",x:function(t){return Math.max(t.getColumnWidth()-5,0)},y:0,width:5}),u.select(".weightHandle").attr({x:function(t){return Math.max(t.getColumnWidth()-5,0)},height:function(t){return t.height}}).call(this.dragWeight)),c.append("text").attr({"class":"headerLabel",x:s.htmlLayout.labelLeftPadding}),c.append("title");var d=a.getClipSource.apply(this.$container[0][0]);if(u.select(".headerLabel").classed("sortedColumn",function(t){var e=s.columnBundles[t.columnBundle].sortedColumn;return e===t}).attr({y:function(e){return e instanceof t.LayoutStackedColumn||null!=e.parent?e.height/2:3*e.height/4},"clip-path":function(t){return"url("+d+"#clip-H"+t.id+")"}}).text(function(t){return t.getLabel()}),u.select("title").text(function(t){return t.getLabel()}),c.append("text").attr({"class":"headerSort",y:function(t){return t.height/2},x:2}),u.select(".headerSort").text(function(t){var e=s.columnBundles[t.columnBundle].sortedColumn;return e===t?s.columnBundles[t.columnBundle].sortingOrderAsc?"":"":""}).attr({y:function(t){return t.height/2}}),this.config.manipulative){var f=[{"class":"stackedColumnInfo",text:"",filter:function(e){return e instanceof t.LayoutStackedColumn?[e]:[]},action:function(t){a.stackedColumnOptionsGui(t)}},{"class":"singleColumnDelete",text:"",filter:function(e){return e instanceof t.LayoutStackedColumn||e instanceof t.LayoutEmptyColumn||e instanceof t.LayoutActionColumn?[]:[e]},action:function(t){a.storage.removeColumn(t),a.listeners["columns-changed"](a),a.headerUpdateRequired=!0,a.updateAll()}},{"class":"singleColumnFilter",text:"",filter:function(t){return t.column?[t]:[]},offset:s.htmlLayout.buttonWidth,action:function(n){n instanceof t.LayoutStringColumn?a.openFilterPopup(n,e.select(this)):n instanceof t.LayoutCategoricalColumn?a.openCategoricalFilterPopup(n,e.select(this)):n instanceof t.LayoutNumberColumn&&a.openMappingEditor(n,e.select(this))}}];f.forEach(function(t){var e=u.selectAll("."+t["class"]).data(t.filter);e.exit().remove(),e.enter().append("text").attr("class","fontawe "+t["class"]).text(t.text).on("click",t.action),e.attr({x:function(e){return e.getColumnWidth()-s.htmlLayout.buttonRightPadding-(t.offset||0)},y:s.htmlLayout.buttonTopPadding})})}var p=e.values(s.svgLayout.plusSigns),g=o.selectAll(".addColumnButton").data(p);g.exit().remove();var m=g.enter().append("g").attr({"class":"addColumnButton"});g.attr({transform:function(t){return"translate("+t.x+","+t.y+")"}}),m.append("title").text(function(t){return t.title}),m.filter(function(t){return!t.render}).append("rect").attr({x:0,y:0,rx:5,ry:5,width:function(t){return t.w},height:function(t){return t.h}}).on("click",function(t){n.isFunction(t.action)?t.action.call(a,t):a[t.action](t)}),m.filter(function(t){return!t.render}).append("text").attr({x:function(t){return t.w/2},y:function(t){return t.h/2}}).text(function(t){return t.text||""}),m.filter(function(t){return!!t.render}).append(function(t){return t.render.call(a,t)}).on("click",function(t){n.isFunction(t.action)?t.action.call(a,t):a[t.action](t)})}},t.prototype.hoverHistogramBin=function(n){if(this.config.renderingOptions.histograms){var i=this.$header.selectAll("g.hist");i.selectAll("rect").classed("hover",!1),n&&this.$header.selectAll("g.hist").each(function(i){if(i instanceof t.LayoutNumberColumn){var r=this;i.getHist(function(t){t&&i.binOf(n,function(t){t>=0&&e.select(r).select("rect:nth-child("+(t+1)+")").classed("hover",!0)})})}})}},t.prototype.addResortDragging=function(n){function i(n){n instanceof t.LayoutEmptyColumn||(e.event.sourceEvent.stopPropagation(),e.select(this).classed("dragObject",!0),c=null,h=!1)}function r(n){function i(t,e,n){return e>t.offsetX&&e-t.offsetX<t.getColumnWidth()&&n>t.offsetY&&n-t.offsetY<t.height?e-t.offsetX<t.getColumnWidth()/2?{column:t,insert:"l",tickX:t.offsetX,tickY:t.offsetY,tickH:t.height}:{column:t,insert:"r",tickX:t.offsetX+t.getColumnWidth(),tickY:t.offsetY,tickH:t.height
}:null}if(!(n instanceof t.LayoutEmptyColumn)){h=!0;var r=u.selectAll(".dragHeader").data([n]),o=r.enter().append("g").attr({"class":"dragHeader"});o.append("rect").attr({"class":"labelBG",width:function(t){return t.getColumnWidth()},height:function(t){return t.height}});var a=e.event.x,l=e.event.y;r.attr("transform",function(){return"translate("+(e.event.x+3)+","+(e.event.y-10)+")"});var d=[];s.storage.getColumnLayout().forEach(function(t){t.flattenMe(d,{addEmptyColumns:!0})});var f=0;for(c=null;f<d.length&&null==c;)c=i(d[f],a,l),f++;var p=u.selectAll(".columnTick").data(c?[c]:[]);p.exit().remove(),p.enter().append("rect").attr({"class":"columnTick",width:10}),p.attr({x:function(t){return t.tickX-5},y:function(t){return t.tickY},height:function(t){return t.tickH}})}}function o(n){e.event.defaultPrevented||n instanceof t.LayoutEmptyColumn||(e.select(this).classed("dragObject",!1),u.selectAll(".dragHeader").remove(),u.selectAll(".columnTick").remove(),c&&c.column===this.__data__||(c&&(e.event.sourceEvent.altKey?s.storage.copyColumn(this.__data__,c.column,c.insert):s.storage.moveColumn(this.__data__,c.column,c.insert),s.listeners["columns-changed"](s),s.headerUpdateRequired=!0,s.updateAll()),null==c&&h&&(s.headerUpdateRequired=!0,s.storage.removeColumn(this.__data__),s.listeners["columns-changed"](s),s.updateAll())))}if(this.config.manipulative){var a=e.behavior.drag(),s=this,l=this.$header,u=l.select("g.overlay"),c=null,h=!1;a.call(n),a.on("dragstart",i).on("drag",r).on("dragend",o)}},t.prototype.addNewEmptyStackedColumn=function(){this.storage.addStackedColumn(null,-1),this.headerUpdateRequired=!0,this.listeners["columns-changed"](this),this.updateAll()},t.prototype.clearSelection=function(){this.select()},t.prototype.getClipSource=function(){return this.ownerDocument&&this.ownerDocument.documentURI!==this.ownerDocument.baseURI?this.ownerDocument.documentURI:""},t.prototype.reweightHeader=function(t){t.column.setColumnWidth(t.value),this.headerUpdateRequired=!0,this.updateAll()}}(i||(i={}),e,t),i}if(0)if("object"==typeof t&&t.exports){var s=require("jquery");t.exports=a(s.extend?s:s(window),require("d3"),require("underscore"))}else this.LineUp=a(jQuery,d3,_);else r=[n(1),n(3),n(2)],i=a,o="function"==typeof i?i.apply(e,r):i,!(void 0!==o&&(t.exports=o))}).call(void 0)},function(t,e,n){var i;(function(t,r,o){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	 * @version   3.1.2
	 */
"use strict";(function(){function a(t){return"function"==typeof t||"object"==typeof t&&null!==t}function s(t){return"function"==typeof t}function l(t){X=t}function u(t){z=t}function c(){return function(){t.nextTick(g)}}function h(){return function(){j(g)}}function d(){var t=0,e=new tt(g),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function f(){var t=new MessageChannel;return t.port1.onmessage=g,function(){t.port2.postMessage(0)}}function p(){return function(){setTimeout(g,1)}}function g(){for(var t=0;Y>t;t+=2){var e=it[t],n=it[t+1];e(n),it[t]=void 0,it[t+1]=void 0}Y=0}function m(){try{var t=n(14);return j=t.runOnLoop||t.runOnContext,h()}catch(e){return p()}}function y(t,e){var n=this,i=n._state;if(i===st&&!t||i===lt&&!e)return this;var r=new this.constructor(C),o=n._result;if(i){var a=arguments[i-1];z(function(){R(i,r,a,o)})}else W(n,r,t,e);return r}function v(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(C);return _(n,t),n}function C(){}function b(){return new TypeError("You cannot resolve a promise with itself")}function x(){return new TypeError("A promises callback cannot return that same promise.")}function w(t){try{return t.then}catch(e){return ut.error=e,ut}}function k(t,e,n,i){try{t.call(e,n,i)}catch(r){return r}}function L(t,e,n){z(function(t){var i=!1,r=k(n,e,function(n){i||(i=!0,e!==n?_(t,n):O(t,n))},function(e){i||(i=!0,D(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&r&&(i=!0,D(t,r))},t)}function S(t,e){e._state===st?O(t,e._result):e._state===lt?D(t,e._result):W(e,void 0,function(e){_(t,e)},function(e){D(t,e)})}function A(t,e,n){e.constructor===t.constructor&&n===rt&&constructor.resolve===ot?S(t,e):n===ut?D(t,ut.error):void 0===n?O(t,e):s(n)?L(t,e,n):O(t,e)}function _(t,e){t===e?D(t,b()):a(e)?A(t,e,w(e)):O(t,e)}function E(t){t._onerror&&t._onerror(t._result),N(t)}function O(t,e){t._state===at&&(t._result=e,t._state=st,0!==t._subscribers.length&&z(N,t))}function D(t,e){t._state===at&&(t._state=lt,t._result=e,z(E,t))}function W(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+st]=n,r[o+lt]=i,0===o&&t._state&&z(N,t)}function N(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,r,o=t._result,a=0;a<e.length;a+=3)i=e[a],r=e[a+n],i?R(n,i,r,o):r(o);t._subscribers.length=0}}function T(){this.error=null}function B(t,e){try{return t(e)}catch(n){return ct.error=n,ct}}function R(t,e,n,i){var r,o,a,l,u=s(n);if(u){if(r=B(n,i),r===ct?(l=!0,o=r.error,r=null):a=!0,e===r)return void D(e,x())}else r=i,a=!0;e._state!==at||(u&&a?_(e,r):l?D(e,o):t===st?O(e,r):t===lt&&D(e,r))}function V(t,e){try{e(function(e){_(t,e)},function(e){D(t,e)})}catch(n){D(t,n)}}function I(t){return new mt(this,t).promise}function P(t){function e(t){_(r,t)}function n(t){D(r,t)}var i=this,r=new i(C);if(!Q(t))return D(r,new TypeError("You must pass an array to race.")),r;for(var o=t.length,a=0;r._state===at&&o>a;a++)W(i.resolve(t[a]),void 0,e,n);return r}function M(t){var e=this,n=new e(C);return D(n,t),n}function H(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function $(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],C!==t&&("function"!=typeof t&&H(),this instanceof U?V(this,t):$())}function q(t,e){this._instanceConstructor=t,this.promise=new t(C),Array.isArray(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&O(this.promise,this._result))):D(this.promise,this._validationError())}function F(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(t.Promise=gt)}var G;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var j,X,K,Q=G,Y=0,z=function(t,e){it[Y]=t,it[Y+1]=e,Y+=2,2===Y&&(X?X(g):K())},J="undefined"!=typeof window?window:void 0,Z=J||{},tt=Z.MutationObserver||Z.WebKitMutationObserver,et="undefined"!=typeof t&&"[object process]"==={}.toString.call(t),nt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,it=new Array(1e3);K=et?c():tt?d():nt?f():void 0===J&&"function"=="function"?m():p();var rt=y,ot=v,at=void 0,st=1,lt=2,ut=new T,ct=new T,ht=I,dt=P,ft=M,pt=0,gt=U;U.all=ht,U.race=dt,U.resolve=ot,U.reject=ft,U._setScheduler=l,U._setAsap=u,U._asap=z,U.prototype={constructor:U,then:rt,"catch":function(t){return this.then(null,t)}};var mt=q;q.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},q.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===at&&t>n;n++)this._eachEntry(e[n],n)},q.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===ot){var r=w(t);if(r===rt&&t._state!==at)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===gt){var o=new n(C);A(o,t,r),this._willSettleAt(o,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(i(t),e)},q.prototype._settledAt=function(t,e,n){var i=this.promise;i._state===at&&(this._remaining--,t===lt?D(i,n):this._result[e]=n),0===this._remaining&&O(i,this._result)},q.prototype._willSettleAt=function(t,e){var n=this;W(t,void 0,function(t){n._settledAt(st,e,t)},function(t){n._settledAt(lt,e,t)})};var yt=F,vt={Promise:gt,polyfill:yt};"function"=="function"&&n(11).amd?(i=function(){return vt}.call(e,n,e,o),!(void 0!==i&&(o.exports=i))):"undefined"!=typeof o&&o.exports?o.exports=vt:"undefined"!=typeof this&&(this.ES6Promise=vt),yt()}).call(void 0),o.exports=r.Promise}).call(e,n(5),function(){return this}(),n(4)(t))},function(t,e){"use strict";var n=function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){var n=this,i=this.listeners[t]=this.listeners[t]||[];return i.push(e),{destroy:function(){n.off(t,e)}}},t.prototype.off=function(t,e){var n=this.listeners[t];if(n){var i=n.indexOf(e);i>=0&&n.splice(i,1)}},t.prototype.raiseEvent=function(t){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this.listeners[t];r&&r.forEach(function(t){t.apply(e,n)})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){"use strict";var i=n(8),r=n(10),o=n(2),a=n(3),s=n(1),l=n(6),u=function(){function t(e){var n=this;this.queryOptions={offset:0,count:t.DEFAULT_COUNT},this.template='\n        <div class="lineup-component">\n            <div class="nav">\n                <ul>\n                    <li class="clear-selection" title="Clear Selection">\n                        <a>\n                            <span class="fa-stack">\n                                <i class="fa fa-check fa-stack-1x"></i>\n                                <i class="fa fa-ban fa-stack-2x"></i>\n                            </span>\n                        </a>\n                    </li>\n                    <li class="add-column" title="Add Column">\n                        <a>\n                            <span class="fa-stack">\n                                <i class="fa fa-columns fa-stack-2x"></i>\n                                <i class="fa fa-plus-circle fa-stack-1x"></i>\n                            </span>\n                        </a>\n                    </li>\n                    <li class="add-stacked-column" title="Add Stacked Column">\n                        <a>\n                            <span class="fa-stack">\n                                <i class="fa fa-bars fa-stack-2x"></i>\n                                <i class="fa fa-plus-circle fa-stack-1x"></i>\n                            </span>\n                        </a>\n                    </li>\n                </ul>\n                <hr/>       \n            </div>\n            <div style="position:relative">\n                <div class="grid"></div>\n                <div class=\'load-spinner\'><div>\n            </div>\n        </div>\n    '.trim(),this._loadingData=!1,this._selectedRows=[],this._settings=s.extend(!0,{},t.DEFAULT_SETTINGS),this.lineUpConfig={svgLayout:{mode:"separate"},interaction:{multiselect:function(){return n.settings.selection.multiSelect}},sorting:{external:!0},filtering:{external:!0},histograms:{generator:function(t,e){return n.generateHistogram(t,e)}}},this.bodyUpdater=o.debounce(function(){n.lineupImpl&&n.lineupImpl.updateBody()},100),this.element=s(this.template),this.element.find(".clear-selection").on("click",function(){n.lineupImpl.clearSelection(),n.raiseClearSelection()}),this.element.find(".add-column").on("click",function(){n.lineupImpl.addNewSingleColumnDialog()}),this.element.find(".add-stacked-column").on("click",function(){n.lineupImpl.addNewStackedColumnDialog()}),this._eventEmitter=new i["default"],e.append(this.element),this.loadingData=!0}return Object.defineProperty(t.prototype,"loadingData",{get:function(){return this._loadingData},set:function(t){this.element.toggleClass("loading",!!t),this._loadingData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._dimensions},set:function(t){this._dimensions=t;var e=this.element.find(".lu-wrapper"),n=this.element.find(".lu-header"),i=this.element.find(".nav");this.bodyUpdater(),e.css({width:t?t.width:null,height:t?t.height-n.height()-i.height():null})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.queryOptions.count||t.DEFAULT_COUNT},set:function(e){this.queryOptions.count=e||t.DEFAULT_COUNT},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataProvider",{get:function(){return this._dataProvider},set:function(t){this.queryOptions.offset=0,this.loadingData=!1,this.lastQuery=void 0,this._dataProvider=t,this._dataProvider?this.runQuery(!0):this.lineupImpl&&(this.lineupImpl.destroy(),delete this.lineupImpl)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return this._eventEmitter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return this._settings},set:function(e){var n=s.extend(!0,{},t.DEFAULT_SETTINGS,e);n.selection.singleSelect,n.selection.multiSelect;if(this.lineupImpl){var i=n.presentation;for(var r in i)i.hasOwnProperty(r)&&this.lineupImpl.changeRenderingOption(r,i[r]);this.lineupImpl.changeInteractionOption("tooltips",n.presentation.tooltips)}this.lineUpConfig.columnColors=n.presentation.columnColors,this.lineUpConfig.interaction.tooltips=n.presentation.tooltips,this._settings=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._selectedRows},set:function(t){this._selectedRows=this.updateRowSelection(t),this.lineupImpl&&this.lineupImpl.select(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"configuration",{get:function(){return this._configuration},set:function(t){this._configuration=t,this.applyConfigurationToLineup()},enumerable:!0,configurable:!0}),t.createConfigurationFromData=function(e){function n(){return e&&e.length?Object.keys(e[0]).filter(function(t){return!l[t]}):[]}function i(t,e){+e>t.max?t.max=e:+e<t.min&&(t.min=+e)}function r(e){return 0===e||null===e||void 0===e||t.isNumeric(e)}function o(t){var n={min:Number.MAX_VALUE,max:0},o=e.every(function(e){return r(e[t])});return o&&e.forEach(function(e){return i(n,e[t])}),{allNumeric:o,minMax:n}}function s(t){var n={column:t,type:"string"},i=o(t),r=i.allNumeric,s=i.minMax;if(r&&(n.type="number",n.domain=[s.min,s.max]),"string"===n.type){var l=a.set(e.map(function(e){return e[t]}));l.size()<=Math.max(20,.2*e.length)&&(n.type="categorical",n.categories=l.values().sort())}return n}var l={selected:!0,equals:!0},u=(n(),n().map(s));return{primaryKey:"id",columns:u}},t.prototype.getSortFromLineUp=function(){if(this.lineupImpl&&this.lineupImpl.storage){var t=this.lineupImpl.storage.config.columnBundles.primary,e=t.sortedColumn;if(e){if(e.column)return{column:e.column.column,asc:t.sortingOrderAsc};var n=a.sum(e.childrenWidths);return{stack:{name:e.label,columns:e.children.map(function(t,i){return{column:t.column.column,weight:e.childrenWidths[i]/n}})},asc:t.sortingOrderAsc}}}},t.prototype.runQuery=function(e){var n=this;e&&(this.queryOptions.offset=0),this.dataProvider&&(o.isEqual(this.queryOptions,this.lastQuery)||(this.lastQuery=o.assign({},this.queryOptions),this.raiseLoadMoreData(),this.dataProvider.canQuery(this.queryOptions).then(function(i){return i?(n.loadingData=!0,n.dataProvider.query(n.queryOptions).then(function(i){n._data=n._data||[],n._data=e?i.results:n._data.concat(i.results),n.queryOptions.offset+=i.count;var r=n.configuration||t.createConfigurationFromData(n._data);r.primaryKey="id";var o={};if(o.dataspec=r,delete o.dataspec.file,delete o.dataspec.separator,o.dataspec.data=n._data,o.storage=l.createLocalStorage(n._data,r.columns,r.layout,r.primaryKey),n.lineupImpl)n.lineupImpl.changeDataStorage(o);else{var u=s.extend(!0,n.lineUpConfig,{renderingOptions:s.extend(!0,{},n.settings.presentation)});n.lineupImpl=l.create(o,a.select(n.element.find(".grid")[0]),u),n.dimensions=n.dimensions,n.lineupImpl.listeners.on("change-sortcriteria.lineup",function(t,e,i){n.onLineUpSorted(e&&e.column&&e.column.id,i)}),n.lineupImpl.listeners.on("multiselected.lineup",function(t){n.settings.selection.multiSelect&&(n._selectedRows=n.updateRowSelection(t),n.raiseSelectionChanged(t))}),n.lineupImpl.listeners.on("selected.lineup",function(t){n.settings.selection.singleSelect&&!n.settings.selection.multiSelect&&(n._selectedRows=n.updateRowSelection(t?[t]:[]),n.raiseSelectionChanged(n.selection))}),n.lineupImpl.listeners.on("columns-changed.lineup",function(){return n.onLineUpColumnsChanged()}),n.lineupImpl.listeners.on("change-filter.lineup",function(t,e){return n.onLineUpFiltered(e)});var c=n.lineupImpl.scrolled,h=n;n.lineupImpl.scrolled=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return h.checkLoadMoreData(!0),c.apply(this,t)},n.settings=n.settings}n.selection=n._data.filter(function(t){return t.selected}),n.applyConfigurationToLineup(),n.saveConfiguration(),n.loadingData=!1,setTimeout(function(){return n.checkLoadMoreData(!1)},10)},function(){return n.loadingData=!1})):void 0})))},t.prototype.generateHistogram=function(t,e){var n=this.getColumnByName(t.column.column);this.dataProvider.generateHistogram(n,this.queryOptions).then(function(t){var n=1/t.length,i=t.map(function(t,e){return{x:n*e,y:t,dx:n}});e(i)})},t.prototype.getColumnByName=function(t){return this.configuration&&this.configuration.columns&&this.configuration.columns.filter(function(e){return e.column===t})[0]},t.prototype.updateRowSelection=function(t){return this._data&&this._data.forEach(function(t){return t.selected=!1}),t&&t.length?t.filter(function(t){return t.selected=!0}):[]},t.prototype.saveConfiguration=function(){if(!this.savingConfiguration){this.savingConfiguration=!0;var t=s.extend({},{},this.lineupImpl.spec.dataspec),e=this.lineupImpl.storage.getColumnLayout().map(function(t){return t.description()});t.layout=o.groupBy(e,function(t){return t.columnBundle||"primary"}),t.sort=this.getSortFromLineUp(),this.configuration=t,delete t.data,this.raiseConfigurationChanged(this.configuration),this.savingConfiguration=!1}},t.prototype.applyConfigurationToLineup=function(){if(this.lineupImpl){var t=this.getSortFromLineUp();if(this.configuration&&this.configuration.sort&&(!t||!o.isEqual(t,this.configuration.sort))){this.sortingFromConfig=!0;var e=this.configuration.sort;this.lineupImpl.sortBy(e.stack?e.stack.name:e.column,e.asc),this.sortingFromConfig=!1}}},t.prototype.checkLoadMoreData=function(t){var e=s(this.lineupImpl.$container.node()).find("div.lu-wrapper")[0],n=e.scrollHeight,i=e.scrollTop;if(!t||this.lastScrollPos!==i){this.lastScrollPos=i;var r=n-(i+e.clientHeight)<200&&n>=200;r&&!this.loadingData&&this.runQuery(!1)}},t.prototype.onLineUpColumnsChanged=function(){this.saveConfiguration()},t.prototype.onLineUpSorted=function(t,e){if(!this.sortingFromConfig){this.saveConfiguration(),this.raiseSortChanged(t,e);var n=this.getSortFromLineUp();this.queryOptions.sort=n?[n]:void 0,this.dataProvider&&this.dataProvider.sort&&this.dataProvider.sort(n),this.runQuery(!0)}},t.prototype.onLineUpFiltered=function(t){var e,n=t.column&&t.column.column,i=this.configuration.columns.filter(function(t){return t.column===n})[0];e="number"===i.type?{column:n,value:{domain:t.scale.domain(),range:t.scale.range()}}:{column:n,value:t.filter},this.saveConfiguration(),this.raiseFilterChanged(e),console.error("This should support multiple filters"),this.queryOptions.query=e?[e]:void 0,this.dataProvider&&this.dataProvider.filter&&this.dataProvider.filter(e),this.runQuery(!0)},t.prototype.raiseConfigurationChanged=function(e){this.events.raiseEvent(t.EVENTS.CONFIG_CHANGED,e)},t.prototype.raiseSortChanged=function(e,n){this.events.raiseEvent(t.EVENTS.SORT_CHANGED,e,n)},t.prototype.raiseFilterChanged=function(e){this.events.raiseEvent(t.EVENTS.FILTER_CHANGED,e)},t.prototype.raiseSelectionChanged=function(e){this.events.raiseEvent(t.EVENTS.SELECTION_CHANGED,e)},t.prototype.raiseLoadMoreData=function(){this.events.raiseEvent(t.EVENTS.LOAD_MORE_DATA)},t.prototype.raiseClearSelection=function(){this.events.raiseEvent(t.EVENTS.CLEAR_SELECTION)},t.PROVIDERS={JSON:r.JSONDataProvider},t.DEFAULT_COUNT=100,t.EVENTS={SORT_CHANGED:"sortChanged",FILTER_CHANGED:"filterChanged",CONFIG_CHANGED:"configurationChanged",SELECTION_CHANGED:"selectionChanged",LOAD_MORE_DATA:"loadMoreData",CLEAR_SELECTION:"clearSelection"},t.DEFAULT_SETTINGS={selection:{singleSelect:!0,multiSelect:!1},presentation:{columnColors:a.scale.category20(),stacked:!0,values:!1,histograms:!0,animation:!0,tooltips:!1}},t.isNumeric=function(t){return t-parseFloat(t)+1>=0},t}();e.TableSorter=u},function(t,e,n){(function(t){"use strict";var n=function(){function e(t,e,n){e===void 0&&(e=!0),n===void 0&&(n=!0),this.handleSort=e,this.handleFilter=n,this.data=t}return e.prototype.canQuery=function(e){var n=this;return new t(function(t){return t(e.offset<n.data.length)})},e.prototype.query=function(e){var n=this;return new t(function(t,i){var r=n.getFilteredData(e),o=r.slice(e.offset,e.offset+e.count);setTimeout(function(){t({results:o,count:o.length})},0)})},e.prototype.generateHistogram=function(e,n){var i=this;return new t(function(t){var r=i.getFilteredData(n),o=r.map(function(t){return t[e.column]}),a=d3.max(o),s=d3.min(o),l=d3.layout.histogram();l.range([s,a]);var u=l(o).map(function(t){return t.y}),c=d3.max(u);t(u.map(function(t){return 0===c||0===t||_.isNaN(t)||_.isNaN(c)?0:t/c}))})},e.prototype.getFilteredData=function(t){var n=this.data.slice(0);if(this.handleFilter&&t.query&&t.query.length&&t.query.forEach(function(t){var i="string"==typeof t.value?e.checkStringFilter:e.checkNumberFilter;n=n.filter(function(e){return i(e,t)})}),this.handleSort&&t.sort&&t.sort.length){var i,r=t.sort[0],o=function(t,e,n){var i=n?1:-1;return t==e?0:(t>e?1:-1)*i},a=function(t,e,n){var i=e.stack.columns;return i?i.reduce(function(e,i){var r=t[i.column];return r?(r-=n[i.column].min,r/=n[i.column].max-n[i.column].min):r=0,e+r*i.weight},0):0};r.stack&&(i=r.stack.columns.reduce(function(t,e){return t[e.column]={max:d3.max(n,function(t){return t[e.column]}),min:d3.min(n,function(t){return t[e.column]})},t},{})),n.sort(function(t,e){return r.stack?o(a(t,r,i),a(e,r,i),r.asc):o(t[r.column],e[r.column],r.asc)})}return n},e.checkStringFilter=function(t,e){return t[e.column].match(new RegExp(e.value))},e.checkNumberFilter=function(t,e){var n=t[e.column]||0;return n>=e.value.domain[0]&&n<=e.value.domain[1]},e}();e.JSONDataProvider=n}).call(e,n(7))},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){t.exports=i},function(t,e){t.exports=r},function(t,e){}])});